package ch4_2

import (
	"fmt"
	"log"
	"net/http"
	"regexp"
)

// cf. https://www.alexedwards.net/blog/validation-snippets-for-go#min-and-max-length-number-of-characters
var rxPat = regexp.MustCompile(`^[a-z0-9]{1,5}$`)

func HealthCheck(w http.ResponseWriter, r *http.Request) {
	r.ParseForm()
	if !rxPat.MatchString(r.Form.Get("key")) {
		log.Printf("[Error] key は1文字以上5文字以下の英数字を入力してください")
		return
	}

	w.WriteHeader(http.StatusOK)
	w.Header().Set("Content-Type", "application/json")

	fmt.Fprintf(w, "Hello World")
}
